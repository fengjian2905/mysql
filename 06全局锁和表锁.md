# 全局锁和表锁

## 全局锁

### 定义

对整个数据库加锁

## 应用场景

全库逻辑备份

## 加锁方法

1. Flush tables with read only（FTWRL）：全库只读  
   
   * 数据更新语句（增删改）阻塞
   * 数据定义语句（建表、修改表结构）阻塞
   * 更新类事务提交阻塞
  
     不好的影响：
     * 主库上备份：备份期间业务停摆
     * 从库备份：备份期间主从同步延迟

2. mysqldump的命令参数--single-transaction，适应所有的表事务引擎的库  
   需要引擎支持，MyISAM这种就不支持

3. set global readonly=true  
   不推荐:  
   * readonly通常作他用，比如判断读库还是写库
   * FTWRL在客户端异常断开时，会释放全局锁  

## 表级锁

> 表级别锁分为表锁和元数据锁